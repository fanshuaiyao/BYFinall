# 1. 引言

## 1.1 研究背景与意义

### 1.1.1 药物研发的现状与挑战

药物研发（Drug Discovery）是一个高投入、长周期、高风险的系统性工程。根据行业统计，研发一种新型临床药物平均需要耗费 10-15 年的时间，投入资金高达 26 亿美元以上。然而，尽管投入巨大，新药研发的成功率却逐年下降，这一现象被称为“反摩尔定律”（Eroom’s Law）。在候选药物进入临床试验之前，准确评估分子的生物活性、药代动力学性质（ADME：吸收、分布、代谢、排泄）以及毒性（Toxicity）是决定其成药性的关键。

传统的药物性质评估主要依赖于生化实验（“湿实验”），虽然结果准确，但由于其实验周期长、成本极高，且无法处理成千上万种候选化合物的初筛需求，已成为新药研发流程中的瓶颈。因此，利用计算机辅助药物设计（CADD）技术，特别是人工智能（AI）和深度学习（DL）方法，在分子进入实验室之前对其性质进行精准预测（“干实验”），已成为现代药理学和化学信息学的迫切需求。

### 1.1.2 分子表征学习的演进

分子性质预测的核心问题在于如何建立有效的“分子表征”（Molecular Representation）。表征学习的质量直接决定了下游预测任务的准确性。

- **传统表征阶段**：早期研究依赖于物理化学描述符（如分子量、脂水分配系数等）和分子指纹（如 Morgan Fingerprints、MACCS keys）。虽然这些方法具有较强的物理意义，但由于是人工设计的特征，往往难以捕获分子深层的非线性结构信息。
- **单模态深度学习阶段**：随着深度学习的兴起，分子的表征开始向自动化特征提取转变。基于 SMILES 序列的自然语言处理（NLP）模型（如 BERT、RNN）将分子视为文本字符串；基于图神经网络（GNN）的模型将分子抽象为拓扑图（节点为原子，边为化学键）。然而，单一模态存在固有的局限性：SMILES 难以直观体现空间拓扑关系，而 2D 图结构可能忽略了分子指纹中的关键官能团信息或 3D 构象的动态特性。
- **多模态学习阶段**：近年来，研究者发现分子具有多种天然存在的“模态”，如 1D 序列、2D 图、3D 空间结构、生物医学文本描述以及分子图像。**GIT-Mol**、**MoleculeSTM** 等前沿研究表明，通过整合多个维度的信息，可以更全面地捕获分子的化学内涵，从而在活性预测、ADMET 评估等任务中超越传统单模态模型。

### 1.1.3 数据稀缺与自监督学习的兴起

在药物性质预测任务中，由于高质量实验数据的获取成本极高，带标签的分子样本往往非常稀缺（通常仅为数千个）。这导致监督学习模型极易出现过拟合。为了应对这一挑战，**MDFCL**、**MMFRL** 等研究引入了自监督学习（Self-supervised Learning）和对比学习（Contrastive Learning）策略。通过在数百万个无标签分子数据上进行预训练，模型可以学习到通用的化学结构知识，再通过微调应用到具体的性质预测任务中，极大地提升了模型在小样本数据上的泛化性能。

------

## 1.2 研究意义

### 1.2.1 理论意义

1. **推动跨模态表征学习理论的发展**：本研究探索如何将分子的异构数据（如图结构、文本知识、分子指纹等）映射到统一的语义空间中。通过研究如 **MLFGNN** 提出的多级融合机制和跨模态注意力交互，能够丰富多模态特征融合的理论体系，解决不同物理意义特征之间的对齐与互补问题。
2. **解决药物研发中的小样本学习问题**：通过引入多模态对比学习（Multimodal Contrastive Learning），本研究能够利用海量的无标签化学数据挖掘分子的内在关联。这为解决化学信息学领域中“标签数据稀缺”这一共性难题提供了新的理论路径。
3. **增强模型的可解释性与泛化性**：结合分子的化学语义信息（如文本描述）和结构信息，不仅能提升预测精度，还能通过注意力权重分析等手段，解释哪些原子或官能团对特定生物活性（如针对乳腺癌的 ERα 活性）起到了决定性作用，为计算化学提供更具逻辑性的参考。

### 1.2.2 实践意义

1. **显著降低药物研发的成本与时间**：本研究构建的多模态性质预测模型，能够对大规模分子数据库进行高通量的虚拟筛选，在实验之前识别出具有高活性和良好 ADMET 性质的候选药物。这不仅能缩短先导化合物的优化时间，还能大幅减少不必要的昂贵实验投入。
2. **助力重大疾病的精准药物筛选**：正如唐文燕等人的研究所揭示的，在抗乳腺癌等特定疾病药物筛选中，多模态模型能更精准地预测分子对特定靶点的抑制能力。本研究的成果可直接服务于抗癌药物、抗病毒药物等的早期研发，提高新药筛选的成功率。
3. **提升药物安全性评估的可靠性**：药物的毒副作用是导致临床试验失败的首要原因。通过建立基于多模态学习的毒性预测模型，可以更早、更全面地识别候选分子的安全风险（如肝毒性、致突变性），从而降低药物上市后的安全隐患，保障公众健康。
4. **促进计算机辅助药物设计的智能化转型**：本研究开发的算法框架（如集成图增强与关系学习的模型）可集成至现有的药物设计软件中，推动医药行业从传统的“试错法”向基于 AI 的“设计-预测-验证”新范式转变，具有重要的经济和社会价值。

## 1.2 国内外研究现状

## 1.3 当前研究不足

## 1.4 研究内容和论文结构



# 2. 数据处理

### 知识增强的多模态文本表征构建

在多模态分子表征学习中，文本模态的质量直接决定了模型捕获高层语义的能力。为了深度挖掘分子结构与宏观理化性质之间的内在逻辑，本文设计并实现了一套基于**结构化事实锚点（Factual Anchors）**与**检索增强生成（RAG）**思想的混合文本构建流程。该流程旨在将抽象的分子序列转化为包含定量事实与定性知识的“专家级描述”，从而为文本编码器提供更具辨识度的语义信息。

#### 分子结构规范化与身份确立

在多模态特征对齐中，确保分子身份的唯一性是消除数据噪音的前提。本文首先利用 RDKit 库对原始 SMILES 字符串进行规范化（Canonicalization）处理。通过算法重新排列原子遍历路径，并严格保留手性（Chirality）中心及立体化学信息（Isomeric SMILES）。这一步确保了分子在图结构（Graph）、分子指纹（Fingerprint）以及文本（Text）模态之间具有统一的索引键值，有效防止了因书写格式不一导致的数据重复与训练泄露。

#### 基于 RDKit 的结构化事实锚点构建

大语言模型在处理精确数值时存在易遗漏或产生“幻觉”的固有缺陷。为确保核心理化特征的绝对保真，本文采用硬编码（Hard-coding）模板构建了“事实锚点（Factual Anchors）”。通过 RDKit 提取了包括分子量（MolWt）、脂水分配系数（MolLogP）、拓扑极性表面积（TPSA）、Balaban J指数等 12 项（见表 X）关键理化指标及拓扑描述符。
这些定量属性被直接填充至预设的学术模板中，形成了文本模态的前半部分。这种结构化的事实列表不仅为下游回归任务（如亲脂性预测）提供了精确的数值参考，还利用固定的语义位置（Positional Encoding）增强了模型提取关键特征的效率。

##### 															表X：知识增强提示词中使用的关键分子描述符及其化学意义

| 序号 | 描述符名称 (Descriptor) | 化学含义与物理性质 | 对性质预测的贡献/意义                                        |
| ---- | ----------------------- | ------------------ | ------------------------------------------------------------ |
| 1    | **Formula**             | **化学式**         | 描述分子的元素组成与比例，是分子最基础的身份标识。           |
| 2    | **MolWt**               | **分子量**         | 衡量分子体量的大小，直接影响分子的密度、扩散速率及药代动力学行为。 |
| 3    | **MolLogP**             | **脂水分配系数**   | 衡量分子的**亲脂性**。它是预测药物在体内分配、吸收及细胞膜渗透性的核心指标。 |
| 4    | **TPSA**                | **拓扑极性表面积** | 衡量分子的**极性大小**。是判断分子能否穿透血脑屏障（BBB）及肠道吸收的重要依据。 |
| 5    | **NumHDonors**          | **氢键供体数**     | 统计分子中可提供氢原子形成氢键的基团。影响分子的溶解度及与靶点蛋白的结合强度。 |
| 6    | **NumHAcceptors**       | **氢键受体数**     | 统计分子中可接受氢原子的电负性原子数量。与分子间的识别和相互作用能密切相关。 |
| 7    | **RingCount**           | **环系统总数**     | 描述分子骨架的环化程度。环数增加通常意味着分子的**结构刚性**与空间复杂性增强。 |
| 8    | **NumAromaticRings**    | **芳香环数量**     | 统计分子中具有芳香性的环数。反映分子通过 `π−ππ−π` 堆积作用影响稳定性的能力。 |
| 9    | **NumRotatableBonds**   | **可旋转键数量**   | 衡量分子的**空间柔韧性**。可旋转键越多，分子的构象越复杂，结合时的熵损失越大。 |
| 10   | **FractionCSP3**        | **sp3 杂化碳比例** | 描述分子的**饱和度与三维性**。较高的比例通常代表分子更立体，有利于改善溶解度。 |
| 11   | **BalabanJ**            | **Balaban J 指数** | 一种先进的拓扑指数。用于量化分子连接的**复杂程度**，能有效区分拓扑异构体。 |
| 12   | **HeavyAtoms**          | **重原子总数**     | 统计除氢以外的所有原子总数。描述分子非氢骨架的整体规模。     |

#### 基于 PUG-View 的领域语义检索

为了引入 SMILES 字符串无法表达的生物学意义与宏观应用背景，本文通过 PubChem 数据库的 PUG-View API 接口进行知识检索。程序化地定位并抓取了 *Names and Identifiers* 板块下的 *Record Description* 模块，获取了源自 ChEBI、MeSH 等权威数据库的百科式描述。这些定性知识涵盖了分子的生物活性（如酶抑制作用）、天然来源、毒性机制及临床用途，为模型理解分子在复杂生物系统中的行为提供了高层语义支撑。

#### 知识对齐与生成式语义升华

在获取定量事实与定性百科后，本文引入 RAG 思想，利用 GPT-4o 对碎片化信息进行二次加工与语义对齐。不同于传统的文本拼接，本文将 RDKit 提取的物理常数与 PubChem 百科共同作为检索增强的上下文（Context）输入大模型。
在大模型的处理过程中，本文强制要求其执行以下逻辑：

1. **因果关联分析**：分析特定的理化指标（如高 LogP）如何与其生物功能（如穿透血脑屏障能力）产生关联；
2. **知识蒸馏与去噪**：剔除百科中冗余的实验参数与厂商信息，仅保留核心化学语义；
3. **标准化输出**：将整合后的深度解读拼接在“事实锚点”之后。
   最终生成的分子文本描述呈现出“**结构化理化常数 + 专家级语义解读**”的双层架构（见表 3-X）。这种表征方式既保证了回归特征的精确度，又赋予了模型深层的科研洞察力，从而最大化地激活了预训练 T5 文本编码器的跨模态对齐能力。

> Aspirin can cause developmental toxicity and female reproductive toxicity according to an independent committee of scientific and health experts.Acetylsalicylic acid appears as odorless white crystals or crystalline powder with a slightly bitter taste. (NTP, 1992)Acetylsalicylic acid is a member of the class of benzoic acids that is salicylic acid in which the hydrogen that is attached to the phenolic hydroxy group has been replaced by an acetoxy group. A non-steroidal anti-inflammatory drug with cyclooxygenase inhibitor activity. It has a role as a non-steroidal anti-inflammatory drug, a non-narcotic analgesic, a platelet aggregation inhibitor, an antipyretic, a cyclooxygenase 2 inhibitor, a cyclooxygenase 1 inhibitor, a prostaglandin antagonist, a teratogenic agent, an anticoagulant, a plant activator, an EC 1.1.1.188 (prostaglandin-F synthase) inhibitor, a drug allergen and a geroprotector. It is a member of benzoic acids, a member of salicylates and a member of phenyl acetates. It is functionally related to a salicylic acid. It is a conjugate acid of an acetylsalicylate.Also known as Aspirin, acetylsalicylic acid (ASA) is a commonly used drug for the treatment of pain and fever due to various causes. Acetylsalicylic acid has both anti-inflammatory and antipyretic effects.  This drug also inhibits platelet aggregation and is used in the prevention of blood clots stroke, and myocardial infarction (MI).    Interestingly, the results of various studies have demonstrated that long-term use of acetylsalicylic acid may decrease the risk of various cancers, including colorectal, esophageal, breast, lung, prostate, liver and skin cancer. Aspirin is classified as a non-selective cyclooxygenase (COX) inhibitor and is available in many doses and forms, including chewable tablets, suppositories, extended release formulations, and others.   Acetylsalicylic acid is a very common cause of accidental poisoning in young children. It should be kept out of reach from young children, toddlers, and infants.Aspirin is a Nonsteroidal Anti-inflammatory Drug and Platelet Aggregation Inhibitor. The mechanism of action of aspirin is as a Cyclooxygenase Inhibitor. The physiologic effect of aspirin is by means of Decreased Prostaglandin Production and Decreased Platelet Aggregation.Aspirin or acetylsalicylic acid is perhaps the most commonly used analgesic and antipyretic medication worldwide, having been in clinical use for over 100 years. Aspirin can cause several forms of liver injury: in high doses, aspirin can cause moderate to marked serum aminotransferase elevations occasionally with jaundice or signs of liver dysfunction, and in lower doses in susceptible children with a febrile illness aspirin can lead to Reye syndrome.Aspirin has been reported in Brassica napus, Ixora coccinea, and Glycyrrhiza glabra with data available.Aspirin is an orally administered non-steroidal antiinflammatory agent. Acetylsalicylic acid binds to and acetylates serine residues in cyclooxygenases, resulting in decreased synthesis of prostaglandin, platelet aggregation, and inflammation. This agent exhibits analgesic, antipyretic, and anticoagulant properties.ASPIRIN is a small molecule drug with a maximum clinical trial phase of IV (across all indications) that was first approved in 1950 and has 19 approved and 143 investigational indications.Aspirin is a mineral with formula of C9H8O4.Acetylsalicylic acid (acetosal) or aspirin is only found in individuals who have consumed this drug. Acetylsalicylic acid is a drug in the family of salicylates, often used as an analgesic (against minor pains and aches), antipyretic (against fever), and anti-inflammatory. It has also an anticoagulant effect and is used in long-term low-doses to prevent heart attacks and cancer. It was isolated from meadowsweet (Filipendula ulmaria, formerly classified as Spiraea ulmaria) by German researchers in 1839. While their extract was somewhat effective, it also caused digestive problems such as irritated stomach and diarrhoea, and even death when consumed in high doses. In 1853, a French chemist named Charles Frederic Gerhardt neutralized salicylic acid by buffering it with sodium (sodium salicylate) and acetyl chloride, creating acetosalicylic anhydride. Gerhardt's product worked, but he had no desire to market it and abandoned his discovery. In 1897, researcher Arthur Eichengrun and Felix Hoffmann, a research assistant at Friedrich Bayer & Co. in Germany, derivatized one of the hydroxyl functional groups in salicylic acid with an acetyl group (forming the acetyl ester), which greatly reduced the negative effects. This was the first synthetic drug, not a copy of something that existed in nature, and the start of the pharmaceuticals industry. The name 'aspirin' is composed of a- (from the acetyl group) -spir- (from the plant genus Spiraea) and -in (a common ending for drugs at the time). It has also been stated that the name originated by another means. As referring to AcetylSalicylic and 'pir' in reference to one of the scientists who was able to isolate it in crystalline form, Raffaele Piria. Finally 'in' due to the same reasons as stated above. Salicylic acid (which is a naturally occurring substance found in many plants) can be acetylated using acetic anhydride, yielding aspirin and acetic acid as a byproduct. It is a common experiment performed in organic chemistry labs, and generally tends to produce low yields due to the relative difficulty of its extraction from an aqueous state. The trick to getting the reaction to work is to acidify with phosphoric acid and heat the reagents under reflux with a boiling water bath for between 40 minutes and an hour. Aspirin acts as an inhibitor of cyclooxygenase which results in the inhibition of the biosynthesis of prostaglandins. Aspirin also inhibits platelet aggregation and is used in the prevention of arterial and venous thrombosis. (From Martindale, The Extra Pharmacopoeia, 30th ed, p5).The prototypical analgesic used in the treatment of mild to moderate pain. It has anti-inflammatory and antipyretic properties and acts as an inhibitor of cyclooxygenase which results in the inhibition of the biosynthesis of prostaglandins. Aspirin also inhibits platelet aggregation and is used in the prevention of arterial and venous thrombosis. (From Martindale, The Extra Pharmacopoeia, 30th ed, p5)See also: Aspirin; caffeine; orphenadrine citrate (component of); Acetaminophen; Aspirin; Caffeine (component of); Aspirin; Omeprazole (component of) ... View More ...

提炼后

> **Acetylsalicylic acid, commonly known as Aspirin, is a synthetic non-steroidal anti-inflammatory drug (NSAID) belonging to the salicylate and benzoic acid classes. Structurally, it is a derivative of salicylic acid in which the phenolic hydrogen has been replaced by an acetoxy group. Its primary mechanism of action involves the non-selective inhibition of cyclooxygenase enzymes (COX-1 and COX-2) by covalently acetylating active-site serine residues. This molecular interaction results in the decreased biosynthesis of prostaglandins and the suppression of platelet aggregation. Clinically, the compound exhibits potent analgesic, antipyretic, and anticoagulant properties, making it a cornerstone in the management of pain, fever, and the prevention of cardiovascular events such as myocardial infarction. Physically, it appears as odorless white crystals or a crystalline powder. However, its pharmacological profile requires careful consideration due to potential developmental toxicity and the associated risk of Reye syndrome in susceptible pediatric populations.**

####  1. 噪声过滤（Denoising）

- **原始文本：** 包含了 1839 年的发现史、1897 年的合成史、德国研究员的名字、甚至错误的描述（矿物质）。
- **精华版本：** 彻底删除了历史故事。对于 Uni-Poly 模型来说，1897 年谁合成了它对预测 LogP 或毒性**没有任何帮助**，删掉这些可以避免模型分配错误的注意力（Attention）。

#### 2. 语义对齐（Semantic Alignment）

- **原始文本：** “Aspirin acts as an inhibitor... Aspirin also inhibits...” 这种句子重复出现了三四次。
- **精华版本：** 将重复的药理作用整合为一句话，并使用了更专业的动词。例如，用 **“covalently acetylating active-site serine residues”**（共价乙酰化活性位点丝氨酸残基）替换了简单的“binds to”（结合），这能让 T5 编码器精准捕获到分子的**反应活性**特征。

#### 3. 因果逻辑构建（Causal Logic）

- **原始文本：** 性质和结构是散乱的。
- **精华版本：** 建立了明确的逻辑。

#### 4. 长度与密度的平衡（Token Efficiency）

- **原始文本：** 约 800 个单词，超过了 512 Token 的限制，会导致最核心的药理部分被强行截断。
- **精华版本：** 约 160 个单词。这意味着即使加上 Part A（那 12 个 RDKit 性质），总长度也能控制在 **300 Token 左右**，完全在 T5 的高效处理范围内，且信息密度提升了 5 倍。

# 3. **基于知识增强与多头注意力机制的多模态药物分子性质预测模型**

## 3.1 模型设计与描述

针对药物分子性质预测中，单一模态表征难以同时捕获分子的拓扑结构、空间构象、理化事实及生物语义信息的问题，本研究设计并实现了一个基于知识增强与多头注意力机制的多模态融合框架（Knowledge-Enhanced Multimodal with Multi-head Attention,  **KEM-MHA**）。

### 3.1.1 总体设计架构

KEM-MHA 模型的总体架构如图 3-1 所示。该模型遵循“全方位表征、知识化增强、动态化融合”的设计原则，主要由四个核心模块组成：

1. **多源异构特征提取模块**：并行利用五个独立的编码器提取分子在不同维度的特征。这五个维度构成了对药物分子的全信息覆盖：

   - **序列模态（SMILES）**：捕获分子的 1D 线性排列规律；
   - **图模态（Graph）**：捕获分子的 2D 拓扑连接关系；
   - **几何模态（Geometry）**：捕获分子的 3D 空间构象与能量分布；
   - **分子指纹模态（Fingerprints）**：引入基于子结构匹配的离散特征；
   - **文本知识模态（Text）**：引入基于 RAG 升华后的外部专家百科与理化事实。

2. **RAG 驱动的知识增强语义模块**：本模型的核心创新点。通过检索增强生成（RAG）技术，将 RDKit 提取的“结构化事实锚点”与从 PubChem 检索的专家百科进行融合，并利用大语言模型（LLM）升华生成高密度的分子专家描述文本。

3. **异构特征投影与对齐模块**：利用线性投影层将上述五个模态输出的维度不一的异构特征向量映射至统一的潜在特征空间（Latent Space），为后续的跨模态交互奠定基础。

4. **多头注意力融合与预测模块**：通过多头注意力机制捕捉不同模态间的深层关联（如指纹中的子结构与文本描述中的生物活性之间的关联），实现权重的自适应分配，并最终通过回归头输出性质预测结果。

   **模型图**

   ![image-20260105171032679](C:/Users/DELL/AppData/Roaming/Typora/typora-user-images/image-20260105171032679.png)

## 3.2 实验设计

### 3.2.1 xxx

## 3.3 实验结果与分析

### 3.3.1 对比试验

| 年份   | 模型      | BBBP           | Tox21        | ToxCast      | Sider        | ClinTox        | Bace         | HIV          | MUV          |
| ------ | --------- | -------------- | ------------ | ------------ | ------------ | -------------- | ------------ | ------------ | ------------ |
| 2025   | MMFRL     | 95.4~0.7       | **85.1~0.1** | **71.9~1.1** | 64.3~1.2     | 93.4~1.1       | **95.1~1.0** | **81.2~1.3** | 82.9~3.1     |
| 2024   | git-mol   | 73.9~0.6       | 75.9~0.5     | 66.8~0.5     | 63.4~0.8     | 88.3~1.2       | 81.08~1.5    | -            | -            |
| 2025   | Molprompt | 75.2           | 79.3         | 67.5         | 66.8         | 94.4           | 81.8         | 78.8         | 77.8         |
| 2025   | MDFCL-GCN | 73.5~1.8       | 76.2~1.4     | -            | **70.0~1.0** | 90.8~1.5       | 87.9~0.9     | 80.7~1.5     | 87.4~2.1     |
| 2025   | MDFCL-GIN | 75.1~1.7       | 79..5~1.0    | -            | 68.7~0.9     | 96.8~1.7       | 85.4~1.2     | 78.7~1.3     | **88.6~1.2** |
| 2025   | SGGRL     | **0.967~0.01** | 0.847~0.013  | -            | 0.682~0.015  | **0979~0.010** | 0.917~0.02   | -            | -            |
| 2025-8 | MLFGNN    | 0.934~0.014    | 0.818~0.007  | -            | 0.647~0.016  | 0.892~0.033    | 0.900~0.027  | -            | -            |



## 3.4 本章小结